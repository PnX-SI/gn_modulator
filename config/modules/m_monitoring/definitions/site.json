{
  "meta": {
    "schema_name": "m_monitoring.site",
    "sql_processing": true,
    "sql_schema_dot_table": "m_monitoring.t_sites",
    "genre": "M",
    "label": "site",
    "label_field_name": "site_name",
    "geometry_field_name": "site_geom",
    "unique": [
      "site_code"
    ]
    // "check_cruved": true,
  },
  "map": {
    "popup_fields": [
      "site_name",
      "site_code",
      "site_desc"
    ]
  },
  "filters": {
    "defs": {
      "type_site": {
        "title": "Type de site",
        "field": "type_site",
        "type": "string",
        "filter_type": "="
      }
    },
    "layout": {
      "key": "type_site",
      "type": "list_form",
      "title": "Type de site",
      "value_field_name": "category_name",
      "schema_name": "m_monitoring.site_category"
    }
  },
  "table": {
    "columns": [
      "id_site",
      "type_site",
      "site_code",
      "site_name"
    ],
    "columns_short": [
      "site_code",
      "site_name",
      "type_site"
    ]
  },
  "required": [
    "site_code",
    "site_name",
    "site_geom"
  ],
  "properties": {
    "id_site": {
      "type": "integer",
      "title": "Pk du site",
      "primary_key": true
    },
    "site_code": {
      "type": "string",
      "title": "Code du site",
      "required": true
    },
    "site_name": {
      "type": "string",
      "title": "Nom du site",
      "required": true
    },
    "site_desc": {
      "type": "string",
      "title": "Description du site"
    },
    "site_geom": {
      "type": "geometry",
      "geometry_type": "geometry",
      "title": "Géométrie",
      "srid": 4326
    },
    "id_site_category": {
      "type": "integer",
      "title": "Catégorie de site",
      "description": "Catégorie de site (pour pouvoir associé des champs spécifiques)",
      "foreign_key": true,
      "schema_name": "m_monitoring.site_category"
    },
    "site_category": {
      "type": "relation",
      "relation_type": "n-1",
      "local_key": "id_site_category",
      "schema_name": "m_monitoring.site_category",
      "title": "Catégorie de site",
      "description": "Catégorie de site (pour pouvoir associé des champs spécifiques)"
    },
        // "type_site": {
        //   "type": "string",
        //   "column_property": "type_complement",
        //   "title": "Type de site"
        // },
    "site_data": {
      "type": "json",
      "description": "Données additionnelles du site",
      "title": "Données additionnelles"
    }
  },
  "form": {
    "layout": [
      "id_site",
      "site_code",
      "site_name",
      // {
      //   "key": "type_site",
      //   "type": "list_form",
      //   "title": "Type de site",
      //   "value_field_name": "category_name",
      //   "schema_name": "m_monitoring.site_category"
      // },
      {
        "key": "site_geom",
        "hidden": true
      }
    ]
  },
  "details": {
    "layout": [
      "id_site",
      "site_code",
      "site_name",
      "type_site"
    ]
  }
}