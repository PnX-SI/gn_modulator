{
  "meta": {
    "schema_name": "m_monitoring.site",
    "sql_processing": true,
    "sql_schema_dot_table": "m_monitoring.t_sites",
    "genre": "M",
    "label": "site",
    "label_field_name": "name",
    "geometry_field_name": "geom",
    "unique": [
      "code"
    ],
    "check_cruved": true
  },
  "map": {
    "popup_fields": [
      "name",
      "code",
      "description",
      "nomenclature_type_site.label_fr",
      "category.name"
    ]
  },
  "table": {
    "columns": [
      "category.name",
      "code",
      "name",
      "nb_visits",
      "last_visit_date_min"
    ],
    "sort": [
      {
        "column": "last_visit_date_min",
        "dir": "desc"
      }
    ]
  },
  "required": [
    "code",
    "name",
    "geom"
  ],
  "form": {
    "layout": [
      {
        "hidden": true,
        "items": [
          "id_site",
          "geom",
          {
            "key": "id_digitiser",
            "default": "__f__meta.currentUser?.id_role"
          }
        ]
      },
      "code",
      "name",
      {
        "key": "id_digitiser",
        "default": "__f__meta.currentUser?.id_role",
        "hidden": true
      },
      {
        "key": "id_site_category",
        "type": "list_form",
        "title": "Cat√©gorie de site",
        "schema_name": "m_monitoring.site_category"
      },
      {
        "key": "id_nomenclature_type_site",
        "type": "list_form",
        "title": "Type de site",
        "schema_name": "ref_nom.nomenclature"
      },
      {
        "display": "fieldset",
        "type": "array",
        "key": "actors",
        "items": {
          "direction": "row",
          "items": [
            {
              "key": "id_role",
              "type": "list_form"
            },
            {
              "key": "id_organism",
              "type": "list_form"
            },
            {
              "key": "id_nomenclature_type_actor",
              "type": "list_form"
            }
          ]
        }
      }
    ]
  },
  "details": {
    "layout": [
      "code",
      "name",
      "type_site",
      "digitiser.nom_complet ",
      "inventor.nom_complet",
      "nomenclature_type_site.label_fr",
      "category.name",
      "label_regions",
      "label_departements",
      "label_communes",
      "label_infrastructures"
    ]
  }
}