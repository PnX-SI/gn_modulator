{
    "$id": "schemas/sipaf/pf",
    "type": "object",
    "$meta": {
        "sql_processing": true,
        "sql_schema_name": "sipaf",
        "sql_table_name": "t_passages_faune",
        "genre": "M",
        "label": "passage à faune",
        "labels": "passages à faune",
        "label_field_name": "nom_pf",
        "geometry_field_name": "geom",
        "check_cruved": true,
        "filters": {
            "defs":{
                "haut_ouvrag_min": { "title": "Hauteur ouvrage min", "field": "haut_ouvrag", "type": "number", "filter_type": ">="},
                "haut_ouvrag_max":{ "title": "Hauteur ouvrage max", "field": "haut_ouvrag", "type": "number", "filter_type": "<="},
                "larg_ouvrag_min":{ "title": "Largeur ouvrage min", "field": "larg_ouvrag", "type": "number", "filter_type": ">="},
                "larg_ouvrag_max":{ "title": "Largeur ouvrage max", "field": "larg_ouvrag", "type": "number", "filter_type": "<="},
                "materiaux":{
                    "title": "Matériaux",
                    "field": "id_nomenclature_materiaux",
                    "filter_type": "=",
                    "type": "integer"
                },
                "nom_pf": { "title": "Nom pf", "field": "nom_pf", "filter_type": "ilike"}
            },
            "layout": [
                "nom_pf",
                {
                    "key": "materiaux",
                    "type": "list-form",
                    "nomenclature_type": "PF_MATERIAUX"
                },
                {
                    "title": "dimensions",
                    "items": [
                        {
                            "direction": "row",
                            "items": ["larg_ouvrag_min", "larg_ouvrag_max"]
                        },
                        {
                            "direction": "row",
                            "items": ["haut_ouvrag_min", "haut_ouvrag_max"]
                        }

                    ]
                }
            ]
        },
        "map": {
            "fields": [
                "id_pf",
                "nom_pf"
            ],
            "popup_fields": [
                "id_pf",
                "nom_pf",
                "pi_ou_ps",
                "lb_materiaux"
            ]
        },
        "form": {
            "layout": [
                {
                   "title": "Informations",
                   "items": [
                        {
                            "direction": "row",
                            "items": [ "nom_pf", "id_op"]
                        },
                        {
                           "direction": "row",
                           "items": [
                            { "items": ["date_creat", "date_requal"] },
                            { "items": ["id_corr", "nom_corr"] },
                            { "items": ["id_obst", "nom_obst"] },
                            { "items": ["id_resv", "nom_resv"] }
                           ]
                        }
                   ]
                },
                {
                    "title": "Type",
                    "direction": "row",
                    "items": [
                        "lb_typ_ouv",
                        "pi_ou_ps",
                        "oh",
                        "specificit"
                    ]
                },
                { "key": "id_nomenclature_materiaux", "type": "list-form", "nomenclature_type": "PF_MATERIAUX"},
                {
                    "direction": "row",
                    "items": [
                        {
                            "title": "Dimensions",
                            "items": [
                                { "direction": "row", "items": ["diam", "long_franch"]},
                                { "direction": "row", "items": ["larg_ouvrag", "haut_ouvrag"]},
                                { "direction": "row", "items": ["larg_disp", "haut_disp"]}
                            ]
                        },
                        {
                            "title": "Localisation",
                            "direction": "row",
                            "items": [
                                { "items": ["cd_com", "pk", "pr", "pr_abs"] }
                            ]
                        }
                        // {
                        //     "items": "geom"
                        // }
                    ]
                },
                {
                    "title": "Banquette (OH)",
                    "direction": "row",
                    "items": [
                        { "key": "id_nomenclature_oh_position", "type": "list-form", "nomenclature_type": "PF_OH_POSITION"},
                        { "key": "id_nomenclature_oh_banq_type", "type": "list-form", "nomenclature_type": "PF_OH_BANQ_TYPE"},
                        { "key": "id_nomenclature_oh_banq_caract", "type": "list-form", "nomenclature_type": "PF_OH_BANQ_CARACT"},
                        "oh_tirant"
                    ]
                }
            ]
        },
        "details": {
            "layout": [
                {
                   "title": "Informations",
                   "items": [
                        {
                            "direction": "row",
                            "items": [ "nom_pf", "id_op"]
                        },
                        {
                           "direction": "row",
                           "items": [
                            { "items": ["date_creat", "date_requal"] },
                            { "items": ["id_corr", "nom_corr"] },
                            { "items": ["id_obst", "nom_obst"] },
                            { "items": ["id_resv", "nom_resv"] }
                           ]
                        }
                   ]
                },
                {
                    "title": "Type",
                    "direction": "row",
                    "items": [
                        "lb_typ_ouv",
                        "pi_ou_ps",
                        "oh",
                        "specificit"
                    ]
                },
                // { "key": "id_nomenclature_materiaux", "type": "list-form", "nomenclature_type": "PF_MATERIAUX"},
                {
                    "direction": "row",
                    "items": [
                        {
                            "title": "Dimensions",
                            "items": [
                                { "direction": "row", "items": ["diam", "long_franch"]},
                                { "direction": "row", "items": ["larg_ouvrag", "haut_ouvrag"]},
                                { "direction": "row", "items": ["larg_disp", "haut_disp"]}
                            ]
                        },
                        {
                            "title": "Localisation",
                            "direction": "row",
                            "items": [
                                { "items": ["cd_com", "pk", "pr", "pr_abs"] }
                            ]
                        }
                        // {
                        //     "items": "geom"
                        // }
                    ]
                },
                {
                    "title": "Banquette (OH)",
                    "direction": "row",
                    "items": [
                        // { "key": "id_nomenclature_oh_position", "type": "list-form", "nomenclature_type": "PF_OH_POSITION"},
                        // { "key": "id_nomenclature_oh_banq_type", "type": "list-form", "nomenclature_type": "PF_OH_BANQ_TYPE"},
                        // { "key": "id_nomenclature_oh_banq_caract", "type": "list-form", "nomenclature_type": "PF_OH_BANQ_CARACT"},
                        "oh_tirant"
                    ]
                }
            ]
        },
        "table": {
            "columns": [
                "id_pf",
                "uuid_pf",
                "nom_pf",
                "cd_com",
                "nom_corr",
                "nomenclature_materiaux.label_fr",
                "date_creat",
                "larg_ouvrag",
                "haut_ouvrag",
                "larg_disp",
                "haut_disp",
                "long_franch",
                "diam",
                "comment",
                "x",
                "y"
            ],
            "columns_short": [
                "id_pf",
                "nom_pf"
            ]
        }
    },
    "properties": {
        "id_pf": {
            "type": "integer",
            "label": "ID PAF",
            "primary_key": true
        },
        "id_dataset": {
            "type": "integer",
            "label": "id_dataset",
            "foreign_key": "schemas/utils/jdd.id_dataset",
            "required": true
        },
        "id_op": {
            "type": "string",
            "label": "Code de l'ouvrage pour le gestionnaire"
        },
        "an_ref_com": {
            "type": "string",
            "label": "Année de référence commune"
        },
        "issu_requa": {
            "type": "string",
            "label": "Issu d'une requalification ?"
        },
        "id_nomenclature_materiaux": {
            "type": "integer",
            "label": "Matériaux",
            "nomenclature_type": "PF_MATERIAUX"
            // "relation_key": "nomenclature_materiaux"
        },
        "nomenclature_materiaux": {
            "rel": "schemas.utils.nomenclature",
            "label": "Matériaux",
            "local_key": "id_nomenclature_materiaux"
        },
        "id_nomenclature_oh_position": {
            "type": "integer",
            "label": "OH Position",
            "nomenclature_type": "PF_OH_POSITION"
        },
        "nomenclature_oh_position": {
            // "type": "string",
            // "label": "OH Position"
            "rel": "schemas.utils.nomenclature",
            "label": "Position banquette",
            "local_key": "id_nomenclature_oh_position"
        },
        "id_nomenclature_oh_banq_caract": {
            "type": "integer",
            "label": "OH Caractrisation banquette",
            "nomenclature_type": "PF_OH_BANQ_CARACT"
        },
        "id_nomenclature_oh_banq_type": {
            "type": "integer",
            "label": "OH type de banquette",
            "nomenclature_type": "PF_OH_BANQ_TYPE"
        },
        "uuid_pf": {
            "type": "uuid",
            "label": "UUID PF"
        },
        "pi_ou_ps": {
            "type": "string",
            "label": "PI ou PF"
        },
        "pk": {
            "type": "number",
            "label": "PK"
        },
        "pr": {
            "type": "number",
            "label": "PR"
        },
        "pr_abs": {
            "type": "number",
            "label": "PR_abs"
        },
        "x": {
            "type": "number",
            "label": "X"
        },
        "y": {
            "type": "number",
            "label": "Y"
        },
        "nom_pf": {
            "type": "string",
            "label": "Nom Passage Faune"
        },
        "cd_com": {
            "type": "string",
            "label": "Code commune"
        },
        "date_creat": {
            "type": "string",
            "label": "Date de creation"
        },
        "date_requal": {
            "type": "string",
            "label": "Date de requalification"
        },
        "larg_ouvrag": {
            "type": "number",
            "label": "Largeur ouvrage"
        },
        "haut_ouvrag": {
            "type": "number",
            "label": "Hauteur ouvrage"
        },
        "long_franch": {
            "type": "number",
            "label": "Longueur"
        },
        "diam": {
            "type": "number",
            "label": "Diamètre"
        },
        "larg_disp": {
            "type": "number",
            "label": "Largeur disponible"
        },
        "haut_disp": {
            "type": "number",
            "label": "Hauteur disponible"
        },
        "specificit": {
            "type": "string",
            "label": "Spécificité"
        },
        "lb_typ_ouv": {
            "type": "string",
            "label": "Type d'ouvrage"
        },
        "lb_materiaux": {
            "type": "string",
            "label": "Matériaux"
        },
        "ep_materiaux": {
            "type": "number",
            "label": "Epaisseur matériaux"
        },
        "oh": {
            "type": "string",
            "label": "Ouvrage hydrolique"
        },
        "oh_position": {
            "type": "string",
            "label": "OH position"
        },
        "oh_caract": {
            "type": "string",
            "label": "OH caract"
        },
        "oh_banqu": {
            "type": "string",
            "label": "OH caract"
        },
        "oh_tirant": {
            "type": "string",
            "label": "OH tirat"
        },
        "id_cer": {
            "type": "string",
            "label": "Reprend id unique du cer"
        },
        "id_corr": {
            "type": "string",
            "label": "ID Corridor"
        },
        "nom_corr": {
            "type": "string",
            "label": "Nom Corridor"
        },
        "id_resv": {
            "type": "string",
            "label": "ID resv"
        },
        "nom_resv": {
            "type": "string",
            "label": "Nom resv"
        },
        "id_obst": {
            "type": "string",
            "label": "ID obst"
        },
        "nom_obst": {
            "type": "string",
            "label": "Nom obst"
        },
        "comment": {
            "type": "string",
            "label": "Commentaire"
        },
        "geom": {
            "type": "geometry",
            "geometry_type": "point",
            "srid": 4326,
            "label": "Geométrie"
        }
    }
}