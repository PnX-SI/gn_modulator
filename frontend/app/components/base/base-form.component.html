<div *ngIf="componentInitialized; else loadingBlock">

  <div class="form-container">

    <!-- Carte avec saisie geoman -->
    <div
      class='map-form'
      *ngIf="schemaConfig.utils.geometry_field_name"
    >

      <div>
        <modules-map
          [mapId]="mapId"
          [height]="height"
          [bEdit]="true"
          [zoom]="zoom"
          [center]="center"
          [layersData]="layersData"
        ></modules-map>
      </div>

    </div>

    <!-- Formulaire -->
    <div class='base-form'>

      <h4 *ngIf="displayTitle"> {{ componentTitle }} </h4>

      <json-schema-form
        [schema]="schemaConfig.form.schema"
        framework="material-design"
        [(data)]="data"
        (onSubmit)="onSubmit($event)"
        (onChanges)="onFormChanges($event)"
        [layout]="processedLayout"
        language=fr
        (isValid)="onIsValid($event)"
        (validationErrors)="onValidationErrors($event)"
      >
      </json-schema-form>

    </div>

    <!-- Debug : valide, erreur et valeurs -->
    <div *ngIf='debug'>
      <div>Valide : {{isValid}}</div>
      <pre>{{validationErrors | json }}</pre>
      <pre>{{data | json}}</pre>
    </div>
  </div>


</div>


<ng-template #loadingBlock>
  <div>Chargement en cours</div>
</ng-template>
