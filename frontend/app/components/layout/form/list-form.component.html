<ng-container *ngIf="!!formControl">
  <mat-form-field
    class="form-field list-form "
    [ngClass]="computedLayout.class"
    [appearance]="context.appearance || 'outline'"
  >
    <mat-label>{{ listFormOptions.title || listFormOptions.key }}</mat-label>
    <mat-select
      [formControl]="formControl"
      [multiple]="listFormOptions.multiple"
      [placeholder]="listFormOptions.placeholder"
      [required]="listFormOptions.required"
      [compareWith]="compareFn"
      [disabled]="computedLayout.disabled"
      (selectionChange)="inputChange($event)"
    >
      <mat-option>
        <ngx-mat-select-search
          placeholderLabel="Filtre"
          [ngModel]="search"
          (ngModelChange)="searchChanged($event)"
          [searching]="isLoading"
          [clearSearchInput]="false"
          noEntriesFoundLabel="Pas de donnÃ©es"
        ></ngx-mat-select-search>
      </mat-option>
      <ng-template ngFor let-item [ngForOf]="items">
        <mat-option
          [ngClass]="{ 'mat-option-hidden': item.hidden }"
          [value]="
            listFormOptions.return_object
              ? item
              : item[listFormOptions.value_field_name]
          "
          [title]="
            (listFormOptions.title_field_name &&
              item[listFormOptions.title_field_name]) ||
            ''
          "
        >
          <span [innerHTML]="item[listFormOptions.label_field_name]"></span>
        </mat-option>
      </ng-template>
    </mat-select>
    <mat-icon
      matPrefix
      *ngIf="listFormOptions.description"
      [matTooltip]="listFormOptions.description"
      class="icon-description"
    >
      help
    </mat-icon>

    <div matSuffix>
      <div>
        <button
          mat-icon-button
          matTooltip="Effacer la selection"
          (click)="clearSelection()"
        >
          <mat-icon class="reset-list-form-button">clear</mat-icon>
        </button>
      </div>
    </div>
    <mat-hint>{{ layout.hint }}</mat-hint>
    <mat-error *ngIf="listFormOptions.required">Ce champs est requis</mat-error>
  </mat-form-field>
</ng-container>
